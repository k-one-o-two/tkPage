(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return i(1277)}])},9271:function(e,t,i){"use strict";i.d(t,{d:function(){return a}});var s=i(5893),n=i(9008),o=i.n(n);function a(e){let{title:t,html:i,art:n}=e;return(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("div",{children:(0,s.jsx)("pre",{style:{paddingRight:"30px",paddingBottom:"10px"},children:(0,s.jsx)("code",{children:n})})}),(0,s.jsx)(o(),{children:(0,s.jsx)("title",{children:t})}),(0,s.jsx)("h1",{children:t}),i]})}},1697:function(e,t,i){"use strict";i.d(t,{z:function(){return a}});var s=i(5893),n=i(5675),o=i.n(n);function a(e){let{src:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{style:{position:"relative",height:"400px",cursor:"pointer"},children:(0,s.jsx)("button",{popovertarget:"pop_".concat(t),children:(0,s.jsx)(o(),{src:t,alt:"Image",fill:!0,style:{objectFit:"contain"}})})}),(0,s.jsxs)("div",{id:"pop_".concat(t),className:"img-dialog",popover:"auto",children:[(0,s.jsxs)("div",{className:"dlg-header",children:[(0,s.jsx)("p",{style:{color:"white"},children:t}),(0,s.jsx)("button",{className:"close-btn",popovertarget:"pop_".concat(t),popovertargetaction:"hide",children:"close"})]}),(0,s.jsx)("div",{className:"img-container",style:{background:"url(".concat(t,") no-repeat 50% 50%"),backgroundSize:"contain"}})]})]})}},4562:function(e,t,i){"use strict";i.r(t),i.d(t,{note:function(){return a}});var s=i(5893),n=i(1697),o=i(9271);let a={title:"Aurora shooting tips",art:"\n████████████████████\n█                  █\n█ ░░▓░░▓░▓░░▓░░░▓  █\n█      ░░▓░░▓░░░▓  █\n█        ░░░▓░░░▓  █\n█                  █\n█                  █\n█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█\n█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█\n████████████████████",html:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{children:"Why"}),(0,s.jsx)("p",{children:"It has been a lot of northern lights lately. They are getting more frequent and intense and I just can't miss these light shows."}),(0,s.jsx)("p",{children:"Here I've decided to try to share some tips on how to shoot it."}),(0,s.jsx)("h3",{children:"Planning"}),(0,s.jsx)("p",{children:"Whatever you are going to use to take your pictures, you still need to find the correct time and place."}),(0,s.jsx)("h4",{children:"Time"}),(0,s.jsx)("p",{children:"This is relatively easy. There are quite a lot of apps that alert you about an upcoming aurora activity. It's better though to find something location specific."}),(0,s.jsxs)("p",{children:["I use 2 main sources, this website:"," ",(0,s.jsx)("a",{href:"https://rwc-finland.fmi.fi/index.php/space-weather-in-finland/",children:"rwc-finland.fmi.fi"})," ","and this TG channel:"," ",(0,s.jsx)("a",{href:"https://t.me/aurora_hunter",children:"Aurora Hunters"}),". The amount of info they give might be overwhelming, but it's safe to ignore it and just react to the red marks (on the web site)."]}),(0,s.jsx)("h4",{children:"Place"}),(0,s.jsx)("p",{children:"This is a bit more complicated. Ideally, you're looking for a lone mountain with a 360 degree view of the sky, which is located in some really dark place. So, the Orodruin might be a good choice. But if you don't live close enough to Mordor, it might be somewhat challenging."}),(0,s.jsx)("p",{children:"So, lets first try to find a place dark enough."}),(0,s.jsxs)("p",{children:["Here's the map:"," ",(0,s.jsx)("a",{href:"https://www.lightpollutionmap.info",children:"lightpollutionmap"}),". I'm not a fan of their color scheme, but the data is extremely useful. What we're looking for is a place that is not too bright AND there's nothing too bright northward from that place. Obviously, the further from civilization you get, the darker it is."]}),(0,s.jsx)("p",{children:"But you actually don't need a complete darkness, auroras can be seen (I mean, seen by your camera) even with some lights in the foreground:"}),(0,s.jsx)(n.z,{src:"/5/3.jpg"}),(0,s.jsx)("p",{children:'Auroras, despite being "northern" lights, are not guaranteed to be directly on the north - actually, the more intense they are, the more random their position is. It may vary both in direction and distance from the horizon - there were several times I\'ve seen it right above my head, like that one:'}),(0,s.jsx)(n.z,{src:"/5/2.jpg"}),(0,s.jsx)("p",{children:'You are going to need a nice, unobstructed view at least to the north. Why "at least?"'}),(0,s.jsx)(n.z,{src:"/5/1.jpg"}),(0,s.jsx)("p",{children:"because this image is shot nearly directly eastward."}),(0,s.jsx)("p",{children:"If there's a whole city to the north of some nice place you've found, the place might be useless."}),(0,s.jsx)("p",{children:"There's a bird-watching tower, that is really high and has a great view, but it's right to the south from Espoo (despite it not being a \"real\" city, it is still rather bright)."}),(0,s.jsx)(n.z,{src:"/5/poll.png"}),(0,s.jsx)("p",{children:"Unless you have some real mountains (and able to climb them) nearby, just getting on top of some hill is not going to help you if the top of said hill is covered in trees, or is surrounded by lights, as shown above."}),(0,s.jsx)("p",{children:"So, in the mountainless place I live in, I've found 3 ways to get the view we need:"}),(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:(0,s.jsx)("p",{children:"Lakes"})}),(0,s.jsx)("li",{children:(0,s.jsx)("p",{children:"Fields"})}),(0,s.jsx)("li",{children:(0,s.jsx)("p",{children:"Bird-watching towers"})})]}),(0,s.jsx)("p",{children:'There\'s a lot of lakes in Finland, but not any will do. First of all, it needs to be long enough along the meridian. By "enough" I mean at least 1 km long.'}),(0,s.jsxs)("p",{children:["In addition, you need to be able to actually stand on it's southern shore - you don't want to mount your tripod in some swamp (ok,"," ",(0,s.jsx)("i",{children:"you"})," might want, but I don't find it so amusing)."]}),(0,s.jsx)("p",{children:"If you're shooting in the middle of the winter it might be less of a problem, since lakes tend to freeze."}),(0,s.jsx)(n.z,{src:"/5/4.jpg"}),(0,s.jsx)("p",{children:"A field might be a good choice as well, though they are typically smaller than lakes and have more light pollution from lampposts (see the 1st image - taken across the field)."}),(0,s.jsx)("p",{children:"Finally, bird-watching tower is sometimes a good option. The problem is that they are typically not high enough to be above all the trees around. Another issue might be it's location - as noted above, one of the highest towers has a bad location, though it allows to make some nice sunset pics."}),(0,s.jsx)(n.z,{src:"/5/5.jpg"}),(0,s.jsx)("p",{children:"So, once you have found the place and got an alert of the aurora activity, you can pack your stuff and go take some pics. But what is that you have to pack?"}),(0,s.jsx)("h3",{children:"Gear"}),(0,s.jsx)("p",{children:"If you're ok with just pointing your phone in the sky and letting it try to make it's best - just skip this part, it's boring."}),(0,s.jsx)("p",{children:"Still here?"}),(0,s.jsx)("p",{children:"I shoot with my DSLR which is a Canon EOS 60D, so I'll be describing it, your results may vary."}),(0,s.jsx)("h4",{children:"Lens"}),(0,s.jsx)("p",{children:"First of all, you're going to need a rather wide lens - all the aurora pics above are shot with my EF-S 10-22mm, mostly dialed all the way to 10. Sometimes I'd like to have even wider angle, but such a lens will be hardly usable for anything else."}),(0,s.jsx)("h4",{children:"Tripod"}),(0,s.jsx)("p",{children:"You're going to need one. A tall one will be easier to use, especially in the snow. It's better if it is adjustable, since you will need to be able to point your camera in different directions."}),(0,s.jsx)("h4",{children:"Settings"}),(0,s.jsx)("p",{children:"This, as well, might be different for you, since cameras and lens are different, but here's some findings."}),(0,s.jsxs)("p",{children:[(0,s.jsx)("b",{children:"Exposure time"}),". Originally, I thought it needs to be as high as possible, but it was a mistake. You see, auroras \"move\" (not like clouds, they disappear in one place and appear in some another) and they do it fast enough to appear too blurry. Therefore, I've realized that 5s time is good enough. Make it longer and you'll get blurry colorful mess, make is shorter and you'll miss some stars in the background."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("b",{children:"ISO"}),". Should be as low as possible to reduce the noise. For me 800 works fine."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("b",{children:"Timer"}),". Do not forget about this feature: you don't want the camera to be moved during the shot, so set a timer (2s is enough) so that it will make a shot in 2s after you release the shutter button."]}),(0,s.jsx)("h3",{children:"Editing"}),(0,s.jsx)("p",{children:"You didn't think these images are not edited, right?"}),(0,s.jsx)(n.z,{src:"/5/6.jpeg"}),(0,s.jsx)("p",{children:"Here is an unedited version of the 3rd image. Yes, my tripod was standing sideways, I know."}),(0,s.jsx)("p",{children:"Apart from making it straight, you might want to increase contrast and saturation of greens and purples or make other adjustments. Anyway, this requires you to use the RAW format."}),(0,s.jsx)("h3",{children:"You're ready now"}),(0,s.jsx)("p",{children:"Or at least, there's nothing more that I can tell you."}),(0,s.jsxs)("p",{children:["Here's"," ",(0,s.jsx)("a",{href:"https://www.flickr.com/photos/k102/albums/72177720305960703/",children:"an album"})," ","where I put my pictures of the sky, including auroras."]})]})};t.default=function(){return(0,s.jsx)(o.d,{art:a.art,title:a.title,html:a.html})}},2169:function(e,t,i){"use strict";i.r(t),i.d(t,{note:function(){return o}});var s=i(5893),n=i(9271);let o={title:"On Telegram bot development",art:"\n████████████████████\n█                  █\n█ ████████████████ █\n█▓█  ██      ██  █▓█\n█▓█              █▓█\n█▓█  ▓▓▓▓▓▓▓▓▓▓  █▓█\n█▓█              █▓█\n█ ████████████████ █\n█                  █\n████████████████████",html:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{children:"Why"}),(0,s.jsx)("p",{children:"As you may have noticed, I like taking pictures. I also like looking at others pics and encouraging people to make and share them."}),(0,s.jsx)("p",{children:"Since I'm somewhat active in the Nerdsbay community, I have decided to create a telegram channel for people to share their photos. No discussions, just photos."}),(0,s.jsx)("p",{children:"But immediately, there is a problem - how do I let people send their images to the channel - obviously, I'd like to be able to either approve or reject those pics."}),(0,s.jsx)("h3",{children:"Let's start"}),(0,s.jsx)("p",{children:"So, we need a public channel, a private group where people will be able to approve images and a bot which will forward messages from the user to that group and then to the channel."}),(0,s.jsxs)("p",{children:["To create a bot, you have to interact with the"," ",(0,s.jsx)("a",{href:"https://t.me/BotFather",children:"bot father"})," - this is pretty straight-forward and I'm gonna skip it here."]}),(0,s.jsx)("p",{children:"We'll be using node.js, let's start with adding a couple of packages we'll need."}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"npm install node-telegram-bot-api"})}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"npm install locallydb"})}),(0,s.jsx)("p",{children:'The 1st one is the api that we\'re going to use to interact with the bot, the 2nd - a rather dumb "database".'}),(0,s.jsx)("p",{children:'The api works pretty much like a web socket - it starts polling and lets you to subscribe to some events. First of all, we need a "photo" event.'}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"\nconst bot = new TelegramBot(token, { polling: true });\n\nbot.on('photo', (msg) => {});\n          "})}),(0,s.jsx)("p",{children:"All the files are stored by telegram separately, so we don't actually need to download it - only memorize it's \"file_unique_id\". Let's save it to the collection:"}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"\nchatsArray.insert({\nuser: msg.chat.id,\nfileId: msg.photo[0].file_unique_id,\nmsgId: msg.message_id,\n});"})}),(0,s.jsx)("p",{children:"We're going to need the id of this chat to be able to respond to the user, who sent the picture."}),(0,s.jsx)("p",{children:"Now we need to forward this message to the admin group, this is pretty straightforward as well."}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"bot.forwardMessage(groupID, msg.chat.id, msg.message_id);"})}),(0,s.jsx)("p",{children:"Next, the bot needs to react to the message in that group and forward the message to the channel and additionally notify the original sender that their picture has been approved (or not)."}),(0,s.jsx)("p",{children:"This is why we have saved the user id into the array - in some cases, a user can hide their username on forwarded messages - the only way to trace the user back is by the file uniq id ."}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"\nbot.onText(/ok\\s?(.*)/, (msg, match) => {\nconst comment = match[1]; // the captured \"comment\"\nbot.forwardMessage(channelID, msg.chat.id, msg.reply_to_message.message_id); // forwarding to the channel\nconst savedUser = getUserByFile(fileId);\nbot.sendMessage(\n  savedUser.user,\n  'we have approved your photo',\n  {\n    reply_to_message_id: savedUser.msgId,\n  },\n);\n...\nconst getUserByFile = (fileId) => {\nconst list = chatsArray.where({ fileId });\nif (list.length() === 0) {\n  return null;\n}\n\nreturn list.items[0];\n};\n      "})}),(0,s.jsx)("p",{children:'Here the bot reacts to a message that matches the regexp (i.e. messages like "ok we like it") if this message came as a reply to the photo in the group.'}),(0,s.jsx)("p",{children:"Additionally, you may want to check that this reply is indeed in the group or it has some approved users in it."}),(0,s.jsx)("h3",{children:"That's it"}),(0,s.jsxs)("p",{children:["You may see this code here:"," ",(0,s.jsx)("a",{href:"https://github.com/k-one-o-two/img-bot",children:"on Github."})]}),(0,s.jsx)("h3",{children:"Wait, how do I run it?"}),(0,s.jsx)("p",{children:"The good thing is that you don't need any domain or even a static IP to host this bot backend. But if you're unhappy with running it on your machine, there's a great option."}),(0,s.jsxs)("p",{children:["You can obtain an"," ",(0,s.jsx)("a",{href:"https://www.oracle.com/cloud/free/",children:"Oracle free tier"})," ","virtual machine. On which you can install any OS you like."]}),(0,s.jsxs)("p",{children:["After trying several options to run my little node script and detach it from the ssh terminal, I've found out that"," ",(0,s.jsx)("a",{href:"https://www.npmjs.com/package/forever",children:"forever"})," works nest for me."]}),(0,s.jsx)("p",{children:"So, install it and run your script:"}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"npm install -g forever && forever start ./app.js"})}),(0,s.jsx)("h3",{children:"Done"}),(0,s.jsx)("p",{children:"In case you'd need a telegram bot for something, you now know how to start!"})]})};t.default=function(){return(0,s.jsx)(n.d,{art:o.art,title:o.title,html:o.html})}},1434:function(e,t,i){"use strict";i.r(t),i.d(t,{note:function(){return a}});var s=i(5893),n=i(1697),o=i(9271);let a={title:"How to not shoot crap",art:"\n████████████████████\n█    ░░ ░  ░░░     █\n█   ░░ ░ ▒▒ ░ ░░   █\n█     ░ ▒▒▒▒ ░░    █\n█ ░ ░  ▒▒▒▒▒▒ ░ ░  █\n█  ░  ▒▒▒▒▒▒▒▒   ░ █\n█ ░  ▒▒▒▒▒▒▒▒▒▒ ░  █\n█   ▒▒▒▒▒▒▒▒▒▒▒▒   █\n█  ▒▒▒▒▒▒▒▒▒▒▒▒▒▒  █\n████████████████████",html:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{children:"Why"}),(0,s.jsxs)("p",{children:["There are plenty of online resources that teach how to make good photos, and this is not a one of them. The thing is - I have no idea (",(0,s.jsx)("b",{children:"update:"})," well, ",(0,s.jsx)("a",{href:"/uncrap",children:"I have some now"}),") what it takes for a photo to be good. But I think I know what makes it a crappy one, and here I'll try to explain it."]}),(0,s.jsx)("h3",{children:"The definition of crap"}),(0,s.jsx)("p",{children:"Take a look at this image (taken by me, not on flickr for obvious reasons):"}),(0,s.jsx)(n.z,{src:"/3/cr1.JPG"}),(0,s.jsx)("p",{children:"What is depicted here? Quite a lot of things actually and in order to check if the image is a crappy one we have to name them all. So, there's a seagull sitting on some fence with a ferry terminal in the background. And there is a line of trucks there. And some out-of-focus thing in the bottom-right corner."}),(0,s.jsx)("p",{children:"The main question is - is that what had been intended to be depicted? In this case I'd say that it is quite clearly not. I mean, I know it for sure since it is my picture, but I'll try to explain why it should be as clear for everyone else."}),(0,s.jsx)("p",{children:"This picture lacks an object, the reason why it was taken in the 1st place. There are several possibilities of what the object could have been:"}),(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:(0,s.jsx)("p",{children:"the terminal: it occupies even less space on the image than parts of the ferry from which the picture is taken, and one corner is even behind the fence. Therefore it can't be the object of this picture."})}),(0,s.jsx)("li",{children:(0,s.jsx)("p",{children:"the fence and the blue floor: is is not even clear if this is just a part of some bridge or a ship, the background makes this fence have too low contrast. The verdict is the same."})}),(0,s.jsx)("li",{children:(0,s.jsx)("p",{children:"the seagull: apart from it being out of focus (I've failed, yeah) it is barely visible due to the terminal on the background"})}),(0,s.jsx)("li",{children:(0,s.jsx)("p",{children:"the weird thing on the right: well, I hope the explanation is not needed here"})})]}),(0,s.jsx)("p",{children:"As you can see, this image lacks an object, it's pointless and there was no good reason to even take this picture."}),(0,s.jsxs)("p",{children:["Consider"," ",(0,s.jsx)("a",{href:"https://www.flickr.com/photos/k102/53719245076",children:"this picture"}),", which is, imho, not a crap:"]}),(0,s.jsx)(n.z,{src:"/3/nc1.jpg"}),(0,s.jsx)("p",{children:"I had an intention to take a picture of a seagull on an evening sky. What do we see here? Right, just that."}),(0,s.jsxs)("p",{children:["One can argue:"," ",(0,s.jsx)("i",{children:"this method only works for minimalistic pictures, like that stupid bird above"}),". So let's take another example."]}),(0,s.jsx)(n.z,{src:"/3/cr2.jpg"}),(0,s.jsx)("p",{children:"This image I took while cycling to Porvoo with my phone. What I wanted to show here is the river, the bridge with nice reflection of it's pillars and some sort of a farmhouse. What do we see here - all of the above plus a part of a metal fence and leafless trees on the right. Let's just crop them out and see if the picture would benefit from it:"}),(0,s.jsx)(n.z,{src:"/3/nc2.jpg"}),(0,s.jsx)("p",{children:"Good, but there still is a partly visible car on the bridge. So, in order to make the picture better we'd better crop it as well. I think you got the idea."}),(0,s.jsx)("p",{children:(0,s.jsx)("i",{children:"So, you're just making an image minimalistic, right?"})}),(0,s.jsx)("p",{children:"Well, yes, but actually no."}),(0,s.jsx)("p",{children:"Sometimes it's not objects that I want to depict. Take a look at this (unedited) image:"}),(0,s.jsx)(n.z,{src:"/3/cr3.JPG"}),(0,s.jsxs)("p",{children:["What do we see here: a van and some pieces of machinery that I can't even name. But the reason I've decided to take this picture is the amount of horizontal lines here: from the dashed line on top to the contrast between the big white thing (which is a ferry, but it doesn't even matter right now) with the way the blue thing aligned almost perfectly parallel to them. Let's try to bring more focus to these lines. To do this, I've"," ",(0,s.jsx)("a",{href:"https://www.flickr.com/photos/k102/53719582599/",children:"made the picture"})," ","b&w while increasing it's contrast. So, while this picture is not minimalistic, now it has more accent on why it has been taken - the geometry of those lines."]}),(0,s.jsx)(n.z,{src:"/3/nc3.jpg"}),(0,s.jsx)("p",{children:"So, the amount of details is now even higher (for example, the mobile fence next to the van is now more visible). Now, my intentions are more aligned with the end result, making a picture (I hope) less crappy."}),(0,s.jsx)("h3",{children:"More examples"}),(0,s.jsx)(n.z,{src:"/3/cr4.JPG"}),(0,s.jsx)("p",{children:"I was trying to take a picture of that bird (as you may have already noticed, I often shoot birds) and I have not even failed with focusing, but the image is still bad. If only this sparrow was sitting a bit to the left, so that it would not blend into the background, it'd be way more clear what is the main object of the picture, which is sadly not. And no matter how you crop this one, it won't be much better for this very reason."}),(0,s.jsx)(n.z,{src:"/3/nc4.jpg"}),(0,s.jsx)("p",{children:"And this bird is much better. It has a nice contrast with the background sky and the branches behind this crow are far enough to be out of focus. The subject is clear - a crow on a tree branch."}),(0,s.jsx)(n.z,{src:"/3/cr5.JPG"}),(0,s.jsx)("p",{children:"There is a lot of things that are bad in this photo, let's try to describe it honestly. We see a tram and this is the only thing that is kinda fine. The reflection of it's lights is obscured by the pile of show, the building behind it is not fully in the frame, there's some radom white car, some part of another building hovering in the left part of the frame... We can continue."}),(0,s.jsx)(n.z,{src:"/3/nc5.jpg"}),(0,s.jsx)("p",{children:"While this one is not ideal either, it is way less crappy - it has a rather clear main object (the tram), it clearly stands out from the background, there are less unrelated objects that may steal the attention."}),(0,s.jsx)("h3",{children:"Conclusion"}),(0,s.jsx)("p",{children:'Ask yourself: "what do I see on the picture?" and try to answer as honest as possible. If the list of things in the answer is significantly longer than you\'d think it should be - the picture is most likely a crap.'})]})};t.default=function(){return(0,s.jsx)(o.d,{art:a.art,title:a.title,html:a.html})}},794:function(e,t,i){"use strict";i.r(t),i.d(t,{note:function(){return a}});var s=i(5893),n=i(1697),o=i(9271);let a={title:"Video with telemetry",art:"\n████████████████████\n█      \xba    \xba      █\n█     \xba      \xba     █\n█    \xba        \xba    █\n█   \xba■■■■■■■■■■\xba   █\n█  \xba ■■  ■■  ■■ \xba  █\n█ \xba  ■■  ■■  ■■  \xba █\n█\xba   ■■      ■■   \xba█\n█180 bpm    42 kmph█\n████████████████████",html:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{children:"Why"}),(0,s.jsx)("p",{children:"Imagine, you went for a ride and recorded a video of it. You have tried so hard, but in the end it doesn't even look fast. They call it a GoPro effect, and there is not much we can do about it. The obvious way to overcome it is to ride even faster or on more harsh terrain."}),(0,s.jsx)("p",{children:"But there's one more way - we can add some data on top of the video to make it at least a bit more entertaining."}),(0,s.jsx)("h3",{children:"How"}),(0,s.jsx)("p",{children:"We will need 3 things:"}),(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:(0,s.jsx)("p",{children:"the video - any kind will do"})}),(0,s.jsx)("li",{children:(0,s.jsx)("p",{children:"the data source - I've used gpx, but others might be used as well"})}),(0,s.jsx)("li",{children:(0,s.jsx)("p",{children:"DashWare"})})]}),(0,s.jsxs)("p",{children:["So, we're gonna be using"," ",(0,s.jsx)("a",{href:"http://www.dashware.net/",children:"DashWare"})," - it's a bit outdated piece of software which purpose is exactly what we need: adding data overlay."]}),(0,s.jsx)("p",{children:"After installing it, create a new project:"}),(0,s.jsx)(n.z,{src:"/2/create.png"}),(0,s.jsx)("p",{children:"Here I have added a video from my camera, gpx is to be added later:"}),(0,s.jsx)(n.z,{src:"/2/data.png"}),(0,s.jsx)("p",{children:"Now we have to synchronize the video with the data, which might be really annoying task."}),(0,s.jsx)(n.z,{src:"/2/sync.png"}),(0,s.jsx)("p",{children:"I've found out that the easiest way to do that is to add a digital speedometer to the video from the Gauge toolbox (any one will do) and find a place where you make a tight turn so your speed is minimal. Once you're happy with the position, check the \"Synchronize with video\" checkbox and take a look at other video parts."}),(0,s.jsx)("h3",{children:"Map data"}),(0,s.jsxs)("p",{children:["There are quite a lot of different gauges to add, GPS map being one of them. The problem is that the map is not really a map, but just your track. Doesn't look too informative. Thankfully, there's a workaround: you may take a screenshot of the actual map (I've used my favorite"," ",(0,s.jsx)("a",{href:"http://maps.stamen.com/toner/",children:"Stamen toner"}),") and use it as a background image in the map settings."]}),(0,s.jsx)(n.z,{src:"/2/align.png"}),(0,s.jsx)("p",{children:"It takes some alignment too, but you don't actually need to be that accurate"}),(0,s.jsx)("p",{children:"Here's how the end result looks like:"}),(0,s.jsx)("iframe",{style:{width:"100%",aspectRatio:"16 / 9"},src:"https://www.youtube.com/embed/DvfDAEua6VI",title:"the end result",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:!0})]})};t.default=function(){return(0,s.jsx)(o.d,{art:a.art,title:a.title,html:a.html})}},9007:function(e,t,i){"use strict";i.r(t),i.d(t,{note:function(){return a}});var s=i(5893),n=i(1697),o=i(9271);let a={title:"Image editing in node.js",art:"\n████████████████████\n█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█\n█▓▓▓▓..           ▓█\n█▓▓▓▓..           ▓█\n█▓▓▓▓       ...   ▓█\n█▓▓▓▓...........  ▓█\n█▓▓▓▓.............▓█\n█▓▓▓▓.............▓█\n█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█\n████████████████████",html:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{children:"Why"}),(0,s.jsxs)("p",{children:["This is also related to the bot, I have described"," ",(0,s.jsx)("a",{href:"/bot",children:"here"}),". Since then, I have found another api that allows reading message history and counting likes on each."]}),(0,s.jsx)("p",{children:"So, I've had an idea to select the best one for each month."}),(0,s.jsxs)("p",{children:["It is not that interesting: you just have to use the"," ",(0,s.jsx)("a",{href:"https://gram.js.org/",children:"telegram"})," npm package and follow the docs."]}),(0,s.jsx)("p",{children:'The channel I\'m talking about is called "Postcards from Finland", therefore I wanted to make those best-liked images look like postcards.'}),(0,s.jsx)("p",{children:"Programmatically, of course."}),(0,s.jsx)("p",{children:"This is my type of fun."}),(0,s.jsx)("h3",{children:"How"}),(0,s.jsx)("p",{children:"There are several npm packages that provide image manipulation possibilities, but the majority of them require 3rd party stuff like Imagemagick, which I didn't want to use - my code should be running on a free tier Oracle VM, so I wanted to keep things as simple as possible."}),(0,s.jsxs)("p",{children:["So, I came across The JavaScript Image Manipulation Program,"," ",(0,s.jsx)("a",{href:"http://jimp-dev.github.io/jimp/",children:"Jimp"}),". Just check out their logo!"]}),(0,s.jsx)("p",{children:"I wanted to achieve a Polaroid-like look, put a postal stamp on and do some writing. The end result should be like that:"}),(0,s.jsx)(n.z,{src:"/6/1.jpg"}),(0,s.jsx)("p",{children:"This, obviously, is not something from the channel, this is my middle finger after I've hurt myself a while ago. Anyway."}),(0,s.jsx)("h4",{children:"Loading an image"}),(0,s.jsx)("p",{children:"First, we'll load an image and get it's dimensions:"}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"\nconst image = await Jimp.read('output.jpg');\nconst { width, height } = image.bitmap;\n        "})}),(0,s.jsx)("p",{children:"Now let's add borders. Either I'm dumb, or there's no built-in way of doing it, so I'm gonna create white rectangles and slap them onto the image:"}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"\nconst border = 20;\n\nconst borderH = new Jimp({ width, height: border, color: 0xffffffff });\nimage.composite(borderH, 0, 0);\n\nconst borderV = new Jimp({ width: border, height, color: 0xffffffff });\nimage.composite(borderV, width - border, 0);\nimage.composite(borderV, 0, 0);\n\nconst borderB = new Jimp({ width, height: border * 4, color: 0xffffffff });\nimage.composite(borderB, 0, height - border * 4);\n        "})}),(0,s.jsx)("p",{children:"This is for the vertical image - the bottom border is 4 times wider."}),(0,s.jsx)("p",{children:"Next, I'll add a black overlay, to make the image look more printed."}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"\nconst overlay = new Jimp({\n    width,\n    height: height - border * 3,\n    color: 0x000000ff,\n  });\noverlay.opacity(0.1);\n\nimage.composite(overlay, 0, 0);\n        "})}),(0,s.jsx)("p",{children:'Adding a stamp is pretty much the same - you load another image and then place it using the "image.composite" method.'}),(0,s.jsx)("h4",{children:"Text"}),(0,s.jsx)("p",{children:"So, the only thing that is missing is the text. It should be easy, right?"}),(0,s.jsx)("p",{children:"Right?"}),(0,s.jsx)("p",{children:'So, I\'ve found some ".ttf" font which I liked and downloaded it. First issue I\'ve encountered is that Jimp docs are outdated and "Jimp.loadFont" doesn\'t seem to exist, it should be imported separately.'}),(0,s.jsx)("p",{children:"The next issue was this:"}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"\nconst font = await loadFont('.my_font.ttf');\n        "})}),(0,s.jsx)("p",{children:"has failed with an error, that I honestly did not even understand. But it was clear, that Jimp is unhappy with this font format. I've looked into it's GitHub and realized that it uses \".fnt\" fonts."}),(0,s.jsx)("p",{children:'At this point I\'ve tried using different libs, like "node-canvas", which, according to the documentation, should be able to use my font.'}),(0,s.jsxs)("p",{children:["It did not. After making several efforts, I've realized I'm not the only one who has a problem and there's an"," ",(0,s.jsx)("a",{href:"https://github.com/Automattic/node-canvas/issues/2255",children:"open GitHub issue"}),"."]}),(0,s.jsx)("p",{children:"So, I've decided to try and convert the font."}),(0,s.jsxs)("p",{children:["Surprisingly, there are different tools for that and some of them just don't work. ",(0,s.jsx)("a",{href:"https://ttf2fnt.com/",children:"This one"})," does."]}),(0,s.jsx)("p",{children:'A ".fnt" is actually just a bitmap, so this tool has generated an image'}),(0,s.jsx)(n.z,{src:"/6/2.png"}),(0,s.jsx)("p",{children:"and a file that describes which part of this image corresponds to which letter"}),(0,s.jsx)(n.z,{src:"/6/3.png"}),(0,s.jsx)("p",{children:"Now, we're one step closer!"}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"\nconst font = await loadFont('.my_font.fnt');\n        "})}),(0,s.jsx)("p",{children:"This works as expected."}),(0,s.jsx)("p",{children:"There's one more thing though: some (well, most of them actually) images are landscape, so the text should go vertical. I have spent more time than I'm willing to admit looking for a way to do that. I have even decided to ask wise people on StackOverflow."}),(0,s.jsx)("p",{children:"But than I've had an idea both dumb and brilliant: rotate an image, print text, rotate back."}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"\n  image.rotate(90);\n\n  image.print({\n    font,\n    x: border,\n    y: width - 50,\n    text: 'tome text goes here',\n  });\n\n  image.rotate(-90);\n        "})}),(0,s.jsx)("h3",{children:"Done"}),(0,s.jsxs)("p",{children:["That's it, the code is"," ",(0,s.jsx)("a",{href:"https://github.com/k-one-o-two/img-bot",children:"on Github."})]}),(0,s.jsxs)("p",{children:["I've learned how to ",(0,s.jsx)("s",{children:"mutilate"}),"manipulate images in node.js, and surely had some specific fun while doing it."]})]})};t.default=function(){return(0,s.jsx)(o.d,{art:a.art,title:a.title,html:a.html})}},1277:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return g}});var s=i(5893),n=i(9008),o=i.n(n);function a(e){let{title:t,children:i,link:n,art:o}=e;return(0,s.jsx)("a",{href:n,children:(0,s.jsxs)("div",{className:"card card-l2",style:{display:"flex",flexWrap:"wrap"},children:[(0,s.jsx)("div",{children:(0,s.jsx)("pre",{style:{paddingRight:"30px",paddingBottom:"10px"},children:(0,s.jsx)("code",{children:o})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"title",children:t}),(0,s.jsx)("div",{className:"content",children:i})]})]})})}var r=i(4562),h=i(2169),l=i(1434),d=i(794),c=i(9007),p=i(3797),u=i(1348),m=i(2639),g=function(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o(),{children:(0,s.jsx)("title",{children:"k102 home page"})}),(0,s.jsxs)("div",{className:"flex flex-column",children:[(0,s.jsx)("div",{className:"text-center"}),(0,s.jsxs)("div",{className:"card",title:"About me",children:[(0,s.jsx)("h1",{children:"About me"}),(0,s.jsx)("p",{children:"I'm a software dev from Saint-Petersburg, living in Espoo."}),(0,s.jsx)("p",{children:"Here are some texts regarding my interests"}),(0,s.jsx)("h1",{children:"Texts"}),(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",flexWrap:"wrap",gap:30,marginBottom:40},children:[(0,s.jsx)(a,{title:"QGIS",link:"/mapping",art:p.note.art,children:(0,s.jsx)("p",{className:"m-0",children:"Notes regarding QGIS usage for creating maps"})}),(0,s.jsx)(a,{title:"Dashware",link:"/dashware",art:d.note.art,children:(0,s.jsx)("p",{children:"Notes on using DashWare tool"})}),(0,s.jsx)(a,{title:"On crappy photo",link:"/crap",art:l.note.art,children:(0,s.jsxs)("p",{children:["This is my attempt to explain how to ",(0,s.jsx)("b",{children:"not shoot"})," crappy photos"]})}),(0,s.jsx)(a,{title:"On not-so-crappy photo",link:"/uncrap",art:m.note.art,children:(0,s.jsxs)("p",{children:["That is my attempt to explain how to ",(0,s.jsx)("b",{children:"shoot not"})," so crappy photos - highly opinionated"]})}),(0,s.jsx)(a,{title:"Auroras",link:"/aurora",art:r.note.art,children:(0,s.jsx)("p",{children:"Yet another guide on how to take pictures of auroras"})}),(0,s.jsx)(a,{title:"TG bot",link:"/bot",art:h.note.art,children:(0,s.jsx)("p",{children:"Notes on using Node.js for Telegram bot backend"})}),(0,s.jsx)(a,{title:"Jimp image editor",link:"/img",art:c.note.art,children:(0,s.jsx)("p",{children:"In case you want to edit images in your Node.js app"})}),(0,s.jsx)(a,{title:"Paginated queries speedup",link:"/speed",art:u.note.art,children:(0,s.jsx)("p",{children:"Notes on improving speed of paginated database queries in Postgresql and Node.js"})})]})]}),(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("h1",{children:"Contacts"}),(0,s.jsx)("div",{children:(0,s.jsxs)("p",{children:["Telegram: ",(0,s.jsx)("a",{href:"https://t.me/k_one_o_two",children:"@k_one_o_two"})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("p",{children:["Matrix:"," ",(0,s.jsx)("a",{href:"https://matrix.to/#/@k.one.o.two:matrix.org",children:"@k.one.o.two"})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("p",{children:["Mail:"," ",(0,s.jsx)("a",{href:"mailto:k.one.o.two@gmail.com",children:"k.one.o.two@gmail.com"})]})})]}),(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("h1",{children:"Social links"}),(0,s.jsx)("div",{children:(0,s.jsx)("a",{href:"https://stackoverflow.com/users/709711/k102",children:"StackOverflow"})}),(0,s.jsx)("div",{children:(0,s.jsx)("a",{href:"https://www.linkedin.com/in/kirill-sergeev-914a02a5/",children:"LinkedIn"})}),(0,s.jsx)("div",{children:(0,s.jsx)("a",{href:"https://github.com/k-one-o-two",children:"Github"})}),(0,s.jsx)("div",{children:(0,s.jsx)("a",{href:"https://www.flickr.com/photos/k102",children:"Flickr"})}),(0,s.jsx)("div",{children:(0,s.jsx)("a",{href:"https://www.deviantart.com/k102",children:"Devianart"})}),(0,s.jsx)("div",{children:(0,s.jsx)("a",{href:"https://www.youtube.com/@k-one-o-two",children:"YouTube"})})]})]})]})}},3797:function(e,t,i){"use strict";i.r(t),i.d(t,{note:function(){return a}});var s=i(5893),n=i(1697),o=i(9271);let a={title:"Own rides map",art:"\n████████████████████\n█    \xb0 \xb0   ███     █\n█    \xb0 \xb0  █████    █\n█\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0██ ██\xb0\xb0\xb0\xb0█\n█\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0█████\xb0\xb0\xb0\xb0█\n█    \xb0 \xb0   ███     █\n█    \xb0 \xb0    █      █\n█\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0█\n█\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0\xb0█\n████████████████████",html:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{children:"Why"}),(0,s.jsxs)("p",{children:["So, I have realized that I ",(0,s.jsx)("i",{children:"need"})," to draw a map of my rides, and do it myself. Yeah, I know that there are a lot of tools out there, but this is not fun. I mean, doing what others have already done way better, suffering meanwhile is fun, right?"]}),(0,s.jsx)("h3",{children:"How"}),(0,s.jsx)("p",{children:'I use Strava, so I have decided to check how can it help me. You can actually export all your data from it. To do so, go to your account settings, you are looking for "Delete" section.'}),(0,s.jsx)(n.z,{src:"/1/delete.png"}),(0,s.jsx)("p",{children:'After pressing the "Get started" button, you will be able to "Request Your Archive" on the next page. You will get a zip archive soon after requesting it.'}),(0,s.jsx)(n.z,{src:"/1/gpxs.png"}),(0,s.jsx)("p",{children:"Great, right?"}),(0,s.jsx)("h4",{children:"No."}),(0,s.jsx)("p",{children:'The thing is, I use Suunto 5 watches to record my activities. It\'s good, but its output is not a gpx, but a fit file, even an archived one. So, along with some gpx files (I used Garmin Edge before), I have received a bunch if "fit.gz" ones'}),(0,s.jsx)("p",{children:"First, I thought to try to use them as they are, but have failed to find a tool to batch convert them into the format I understand. Not that I was looking too hard, but still, It seemed not to be straightforward."}),(0,s.jsx)("h4",{children:"Let's get them from Strava then!"}),(0,s.jsx)("p",{children:"For every Strava activity you may get a gpx file, that's pretty simple"}),(0,s.jsx)(n.z,{src:"/1/export.png"}),(0,s.jsx)("p",{children:"Shortly, I've realized that I have to press this damn button quite a lot (yeah, I didn't bother to count) of times. So, let's automate! It was supposed to be fun, right?"}),(0,s.jsx)("h4",{children:"A bit of code"}),(0,s.jsx)("p",{children:"So, I have downloaded one gpx and recorder my request using Fiddler. This gave me useful headers, that I could use to get other files. Actually, you only need to send the Cooke one. After a couple of minutes I came up with the following:"}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"\nfs = require('fs');\n\nconst save = async (activity) => {\nconst myHeaders = new Headers();\nmyHeaders.append(\n  'Cookie',\n  'Cookie:\n  sp=8e_strava_cbv2=true;..ff',\n);\n\nconst res = await fetch(\n  `https://www.strava.com/\n  activities/\n  ${activity}/\n  export_gpx`,\n  { headers: myHeaders },\n);\n"})}),(0,s.jsx)("p",{children:'The only thing - where do I get those ids? Luckily, there is an "activities" file in the export I\'ve done before. So it was not completely useless, yay!'}),(0,s.jsx)("p",{children:"So just put them into an array and call like that"}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"\nnames.forEach((name) => save(name));\n          "})}),(0,s.jsx)("p",{children:"Surprisingly, there seems to be no limit on such requests, so after a short while, I've got all my desired files."}),(0,s.jsx)("h4",{children:"Now what?"}),(0,s.jsx)("p",{children:"QGIS. This is a powerful software, so I'm a bit ashamed to use it for such a small task, using like 10% of what it is capable of. But after all, I'm already using Lightroom to move a couple of sliders, so why not."}),(0,s.jsx)("p",{children:'Gpx can be imported by using "Layer > Add Layer > Add vector layer" menu.'}),(0,s.jsx)(n.z,{src:"/1/qgis1.png"}),(0,s.jsx)("p",{children:"The only thing I actually needed was a line. After adding them all, don't repeat my mistake and group them together, otherwise you'll keep copying a style from one line to the whole group, QGIS will consume all the RAM it could find."}),(0,s.jsx)("h4",{children:"Adding tiles"}),(0,s.jsx)(n.z,{src:"/1/qgis2.png"}),(0,s.jsxs)("p",{children:["I had to add some XYZ tiles. XYZ means that those tiles are obtained from a tile server by X and Y coordinates and a zoom level. You can add some manually, but it will require some manual work, which is no fun (which is still a goal of the whole thing). I have managed to find a script that will add some well-known tiles to QGIS:",(0,s.jsx)("br",{}),(0,s.jsx)("a",{href:"https://raw.githubusercontent.com/klakar/QGIS_resources/master/collections/Geosupportsystem/python/qgis_basemaps.py",children:"qgis_basemaps.py"}),(0,s.jsx)("br",{}),"There is a Python console (Plugins > Python Console). After running this script I've got a nice list of differently styled tiles."]}),(0,s.jsx)("h3",{children:"Non-flat Earth"}),(0,s.jsx)("p",{children:'So far so good, but the map is flat, while I\'d like to show that I sometimes suffer riding uphill. There are several ways to add elevation data to the map, but the easiest is to use a thing called "hillshade". This is pretty much self explanatory - this is a raster image of shades, produced by hills.'}),(0,s.jsxs)("p",{children:["After quite extensive googling (while I use duckduckgo, so... ducking?), I came across this resource",(0,s.jsx)("br",{}),(0,s.jsx)("a",{href:"https://asiointi.maanmittauslaitos.fi/karttapaikka/?lang=en",children:"asiointi.maanmittauslaitos.fi"}),(0,s.jsx)("br",{}),"It allows to download quite a lot of stuff, the needed hillshade among them:"]}),(0,s.jsx)(n.z,{src:"/1/hillshade.png"}),(0,s.jsx)("p",{children:'After "ordering" it, I have received a message from "no-reply@maanmittauslaitos.fi" with a download link. I\'ve got some .tif files. Not knowing what am I supposed to do with them, I;ve just drag\'n\'dropped them in QGIS. Aaand it just worked, that simple.'}),(0,s.jsx)("h3",{children:"Styling"}),(0,s.jsx)("p",{children:"To actually show the hillshade, I have put a map (OSM) on top of it, and made it's semi-transparent"}),(0,s.jsx)("p",{children:"Now, combining all that I've done before, I have managed to display a non-flat map with my track on it, this is how it looks like"}),(0,s.jsx)(n.z,{src:"/1/hill.png"}),(0,s.jsx)("p",{children:"Well, in reality this hill looks a bit more impressive:"}),(0,s.jsx)(n.z,{height:400,src:"/1/view.jpg"}),(0,s.jsx)("h3",{children:"Adding speed"}),(0,s.jsx)("p",{children:"After performing all of this, I have decided to try and show my speed. Unfortunately, gpx track point does not contain speed, it looks like this:"}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-xml",children:'\n<trkpt lat="60.1824680" lon="24.7411490">\n<ele>35.3</ele>\n<time>2023-02-14T12:15:00Z</time>\n<extensions>\n  <gpxtpx:TrackPointExtension>\n  <gpxtpx:hr>76</gpxtpx:hr>\n  </gpxtpx:TrackPointExtension>\n</extensions>\n</trkpt>\n'})}),(0,s.jsxs)("p",{children:["There is a useful QGIS plugin, called"," ",(0,s.jsx)("a",{href:"https://anitagraser.com/2019/02/02/movement-data-in-gis-20-trajectools-v1-released/",children:"Trajectools"}),", which can be used for exactly this task."]}),(0,s.jsx)(n.z,{src:"/1/trajectools.png"}),(0,s.jsx)("p",{children:'When installed It will add itself to the "Processing toolbox" panel. What I\'ve used was "Basic > Add speed (m/s) to points" This will create a new set of points, each of them contains a new value - speed.'}),(0,s.jsx)("p",{children:"Now, let's colorize them. Unfortunately, I don't know how to colorize a line, so here's how to make it as line-like as possible."}),(0,s.jsx)("p",{children:"First, we need to color each point according to the speed."}),(0,s.jsx)(n.z,{src:"/1/speed1.png"}),(0,s.jsx)("p",{children:"Here we may create an expression which will be used to calculate the color. It can look like this:"}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"ramp_color(\n'blue2red',\nscale_linear(\nmeters_per_sec * 3600 / 1000,\n0,\n30,\n0,\n1)\n)"})}),(0,s.jsx)("p",{children:"The hell does this mean? Yeah, this language is confusing at best. Anyway, here's what is happening here."}),(0,s.jsxs)("p",{children:['"ramp_color" - is a function to calculate the color code (hex). It takes two arguments - name of the gradient (here I\'ve created my own just ',(0,s.jsx)("i",{children:"for fun"}),", but you mau use an existing one) and a value, which should be a number from 0 to 1."]}),(0,s.jsx)("p",{children:'"scale_linear" - since we are required to give [0, 1] value to the "ramp_color" function, we have to normalize our "meters_per_sec" value. So it takes 5 arguments: the value to normalize, its minimum, its maximum, normalized minimum and normalized maximum. So, 0 will become 0, 30 km/h will become 1.'}),(0,s.jsx)(n.z,{src:"/1/speed2.png"}),(0,s.jsx)("p",{children:"The result is not great, but for now this is my best. On this map a hillshade and a Stamen Toner layers were used"}),(0,s.jsx)("h3",{children:"Done"}),(0,s.jsx)("p",{children:"So, that's it. I had some specific fun doing this and learned something new."})]})};t.default=function(){return(0,s.jsx)(o.d,{art:a.art,title:a.title,html:a.html})}},1348:function(e,t,i){"use strict";i.r(t),i.d(t,{note:function(){return a}});var s=i(5893),n=i(9271),o=i(1697);let a={title:"On speed for paginated queries",art:"\n████████████████████\n█                  █\n█                  █\n█  {               █\n█      skip: 1000, █\n█      take: 10    █\n█  }               █\n█                  █\n█                  █\n████████████████████",html:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{children:"The problem"}),(0,s.jsx)("p",{children:"Finally, something that is work-related and not some random stuff I do in my free time."}),(0,s.jsx)("p",{children:"Imagine, you have a huge table, or even a view and you need to query it from the database and present in the UI, with sorting and pagination."}),(0,s.jsxs)("p",{children:["Looks pretty simple: we have"," ",(0,s.jsx)("a",{href:"https://www.postgresql.org/docs/current/queries-limit.html",children:"LIMIT and OFFSET"})," ","specifically for that task. But I would not have written this article, if it was that easy."]}),(0,s.jsx)("p",{children:"The problem here is that if the OFFSET value is too high your query is going to become extremely slow."}),(0,s.jsx)("h3",{children:"More details"}),(0,s.jsxs)("p",{children:["I'm using ",(0,s.jsx)("a",{href:"https://www.postgresql.org/",children:"Postgresql"})," with"," ",(0,s.jsx)("a",{href:"https://www.prisma.io/",children:"Prisma"})," in"," ",(0,s.jsx)("a",{href:"https://nodejs.org/en",children:"Node.js"})," so code snippets would be with those tools. So, consider this query:"]}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"\nconst data = await prisma.someTable\n.findMany({\n  where: {\n      someProperty: 'someValue',\n  },\n  include: {\n      otherTable: {\n          andAnotherOne: true\n      }\n  },\n  orderBy: {\n      field: 'asc'\n  },\n  { \n      skip: 1000,\n      take: 10\n  }\n});\n      "})}),(0,s.jsx)("p",{children:'And... this takes a while to run, easily requiring several seconds. And the more the "skip", the longer it takes.'}),(0,s.jsx)("p",{children:(0,s.jsx)("b",{children:"The sample query takes 6.52s"})}),(0,s.jsx)("h3",{children:"Why is that?"}),(0,s.jsxs)("p",{children:["I have found a great article on this topic,"," ",(0,s.jsx)("a",{href:"https://use-the-index-luke.com/blog/2013-07/pagination-done-the-postgresql-way",children:"here it is"}),". The key takeaway is that with the large skip, database requires a lot of memory, and the more it is, the more memory will be needed (image from the article above):"]}),(0,s.jsx)(o.z,{src:"/7/1.png"}),(0,s.jsx)("p",{children:"That article suggests using indexes, which is indeed a good solution, but might not be applicable. In my app, there is an ability to sort this table and some fields are really hard to index. Some of them have the same value (which is not ok, but I don't control the data), some are composite."}),(0,s.jsxs)("p",{children:["Another issue is that for pagination to work I have to send the total number of rows along with the paginated data. Therefore, I have to run another query to get that count (since the long-awaited"," ",(0,s.jsx)("a",{href:"https://github.com/prisma/prisma/issues/7550",children:"findManyAndCount"})," ","had not been implemented yet)"]}),(0,s.jsx)("h3",{children:"My solution"}),(0,s.jsx)("p",{children:"Once I've realized that the issue is the memory, I've tried to reduce the consumption."}),(0,s.jsx)("p",{children:'So, just to test things, I have removed everything from the "include" property (for those who are unfamiliar with Prisma - it is pretty much SQL join with some extra stuff).'}),(0,s.jsx)("p",{children:(0,s.jsx)("b",{children:"The sample query takes 55ms"})}),(0,s.jsx)("p",{children:"Great! But useless - I still need those included columns, and let's not forget about the count query."}),(0,s.jsx)("p",{children:"But now we know, that queries with includes and without an offset run fast - so let's try to have one."}),(0,s.jsx)("p",{children:"The 1st idea was to pre-select the array of object ids we're going to need for this exact page of pagination and then use it in the big one."}),(0,s.jsx)("p",{children:"Now, let's have 2 queries:"}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"\nconst ids = await prisma.someTable\n.findMany({\n  where: {\n      someProperty: 'someValue',\n  },\n  select: {\n      id: true,\n  },\n  orderBy: {\n      field: 'asc'\n  },\n  { \n      skip: 1000,\n      take: 10\n  }\n});\n\nconst data = await prisma.someTable\n.findMany({\n  where: {\n      id: {\n         in: Object.values(ids).map((id) => id.id),\n      },\n  },\n  include: {\n      otherTable: {\n          andAnotherOne: true\n      }\n  },\n});\n      "})}),(0,s.jsx)("p",{children:(0,s.jsx)("b",{children:"The sample query takes 99ms"})}),(0,s.jsx)("p",{children:"Not as good as without data, but still much better than the initial solution. But I still need the count!"}),(0,s.jsx)("p",{children:'Let\'s rewrite it a bit more. "ids" is just a simple array, therefore it should be actually easy to get the part we need without using sql at all. As as side effect - the full array of ids has the exact same length I needed to sent to the UI.'}),(0,s.jsx)("p",{children:"So, I have removed pagination from the request at all, leaving sorting in the 1st one (the one that gets ids) and moved pagination task to js:"}),(0,s.jsx)("pre",{className:"crt",children:(0,s.jsx)("code",{className:"language-javascript",children:"\nconst paginatedIds = ids.slice(skip, skip + take));\n        "})}),(0,s.jsx)("p",{children:'And then use this paginatedIds array in the "in" clause of the 2nd query.'}),(0,s.jsx)("p",{children:(0,s.jsx)("b",{children:"The sample query takes 81ms"})}),(0,s.jsx)("p",{children:"So, yeah, I have not beaten the 55ms result, but that one was pretty much useless, and now I've got the count as well - therefore this is all I needed from this function and it won't take any more time than that."}),(0,s.jsx)("h3",{children:"done"}),(0,s.jsx)("p",{children:"I can't share the whole code because I've wrote it for work - but you don't have to trust me, better try this approach yourself and see if it is any good in your case."})]})};t.default=function(){return(0,s.jsx)(n.d,{art:a.art,title:a.title,html:a.html})}},2639:function(e,t,i){"use strict";i.r(t),i.d(t,{note:function(){return a}});var s=i(5893),n=i(1697),o=i(9271);let a={title:"How to shoot not crap",art:"\n████████████████████\n███  ░░ ░  ░░░     █\n█  ██░ ░ ▒▒ ░ ░░   █\n█    ███▒▒▒▒ ░░    █\n█ ░ ░  ▒██▒▒▒ ░ ░  █\n█  ░  ▒▒▒▒██▒▒   ░ █\n█ ░  ▒▒▒▒▒▒▒███ ░  █\n█   ▒▒▒▒▒▒▒▒▒▒▒██  █\n█  ▒▒▒▒▒▒▒▒▒▒▒▒▒▒███\n████████████████████",html:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{children:"Why"}),(0,s.jsxs)("p",{children:["Ok, so I've ",(0,s.jsx)("a",{href:"/crap",children:"tried my best"})," do discuss how to not make a crappy image. But then it has been pointed out that these advices only work if you know what is that you're going to shoot. Which is not always the case. So now I'll try to share some ideas on how I pick the subject to take picture of."]}),(0,s.jsx)("p",{children:"Disclaimer: the whole contents of this page is my personal opinion."}),(0,s.jsx)("p",{children:"Well, you have to take good pictures and avoid taking bad ones. But what makes a picture a good one?"}),(0,s.jsx)("p",{children:"I think there are 2 separate metrics, not really connected: how much the image is interesting and how aesthetically pleasing it is."}),(0,s.jsxs)("p",{children:["I also think it is easier to discuss how to make an image good form an aesthetic point of view. Apart from being able to find images with traffic lights, we, humans have other things in common and visual taste is one of them. Of course, there are some overly unique snowflakes, who will claim to like something completely different, but"," ",(0,s.jsx)("s",{children:"who cares"}),"I'm talking about the majority here. So, what are those things?"]}),(0,s.jsx)("h3",{children:"Nature"}),(0,s.jsxs)("p",{children:[(0,s.jsx)("a",{href:"https://www.youtube.com/watch?v=3YTd2eoW5ys",children:"We are animals"})," ","and nature is our habitat: it makes us happy when the sun is shining, flowers are blooming, bunnies are... well, just are, and so on."]}),(0,s.jsx)("p",{children:"Therefore, nature & wildlife pictures mostly always look good. Just get yourself a telephoto lens and go find some cute animals:"}),(0,s.jsx)(n.z,{src:"/4/3.jpg"}),(0,s.jsx)(n.z,{src:"/4/4.jpg"}),(0,s.jsx)("p",{children:"Places with a view are as well safe bet: we like such places since prehistoric times, even paleontologists tend to search for prehistoric habitats in places with a view"}),(0,s.jsx)(n.z,{src:"/4/5.jpg"}),(0,s.jsx)("h3",{children:"Architecture"}),(0,s.jsx)("p",{children:"Another common thing to shoot is some architectural landmarks. It is easier than shooting bunnies as buildings tend to stay in place, and to be built in a way that makes it easy to look at them and take pictures. But it is actually a problem."}),(0,s.jsxs)("p",{children:[" ",(0,s.jsx)("a",{href:"https://www.flickr.com/photos/k102/20063048778/in/album-72157656308523978/",children:"Consider this one"}),":"]}),(0,s.jsx)(n.z,{src:"/4/1.jpg"}),(0,s.jsx)("p",{children:"This is a Parliament building in Budapest. This picture is rather old, taken in 2015. I think it's ok in terms of aesthetics: the building is beautiful, it has this nice lighting etc. I only had to not f*ck it up too much, which I hope I did not. Now, let's use a search engine to look for other pictures of that place:"}),(0,s.jsx)(n.z,{src:"/4/2.png"}),(0,s.jsx)("p",{children:"Have you noticed it? No? I've inserted the picture above into this one and it looks as if it was there (well, I hope so at least). Which means that this is not an interesting picture - everyone can get the same one, most likely yours won't be the best from a technical point of view."}),(0,s.jsxs)("p",{children:["You can always say something like:\xa0",(0,s.jsx)("a",{href:"https://www.youtube.com/watch?v=kGoACnq46i4",children:'"There are many like it'}),', but this one is mine". And it might be fine, but unless you can afford traveling really often, you will soon run out of landmarks in your city.']}),(0,s.jsx)("p",{children:"Therefore, we need to take more interesting pictures."}),(0,s.jsx)("h3",{children:"How?"}),(0,s.jsx)("p",{children:"So, as we now agree (right?), architecture itself is not exactly interesting."}),(0,s.jsx)("p",{children:"Nature photos, even if you're infinitely far from NatGeo photographers, are better in this regard, especially for city-dwellers. But how can we improve it?"}),(0,s.jsx)("h3",{children:"Lighting"}),(0,s.jsxs)("p",{children:["Technically, we're not taking pictures of objects. We capture some light that has been reflected by them, sometimes we capture"," ",(0,s.jsx)("i",{children:"just"})," the light itself - think of shooting stars or auroras or a rainbow."]}),(0,s.jsx)("p",{children:"Therefore, to make a picture more interesting, you may try to have somewhat interesting lighting. The most obvious idea would be to take pictures of a sunset (or sunrise, but it's just too hard)."}),(0,s.jsx)(n.z,{src:"/4/6.jpg"}),(0,s.jsx)(n.z,{src:"/4/7.jpg"}),(0,s.jsx)("p",{children:"These images would be way less interesting if not the sunset that colors the sky and clouds in this nice yellow."}),(0,s.jsx)("p",{children:"Worth mentioning that now your subject is the sunset itself, so it should affect the composition (in other words - more sky, less everything else)"}),(0,s.jsx)("p",{children:"But what if you want to make a day picture better?"}),(0,s.jsx)("p",{children:"Well, lights to the rescue! It might be a good idea to let the sunlight in your lens. It really helps during the winter, when there's not enough colors."}),(0,s.jsx)(n.z,{src:"/4/8.jpg"}),(0,s.jsx)("p",{children:"Here I've pointed my camera pretty much directly to the low winter sun and then made a picture a bit warmer in post-production. As a result - this is no longer a picture of the forest, but a picture of light making it's way through the trees."}),(0,s.jsx)("h3",{children:"Not only sunset"}),(0,s.jsx)("p",{children:"There are other lighting events that may help in creating a more interesting picture. The most common one is the fog. It does not only reduce the visibility, it affects artificial lights making them softer."}),(0,s.jsx)(n.z,{src:"/4/10.jpg"}),(0,s.jsx)("p",{children:"Back to architectural example. This picture would be completely uninteresting in good weather conditions, but the fog makes it unique - a lot of people can take a picture of this same place, but you had to be there in the correct time to see it all covered with the fog."}),(0,s.jsx)("p",{children:"Unlike the Hungarian Parliament picture, this one at least tries to be an interesting one, though this building is not a landmark."}),(0,s.jsx)(n.z,{src:"/4/9.jpg"}),(0,s.jsx)("p",{children:"Even more extreme example - this is literally a picture of light rays in the fog. I think this picture gets pretty low aesthetic score, but should be considered somewhat interesting."}),(0,s.jsx)("h3",{children:"People & streetphoto"}),(0,s.jsx)("p",{children:"This is a way trickier one. There are pretty much 2 ways of photographing people - either staged or not. And I don't even know what's harder. For the 1st one you might need special equipment: either lights or flashes, or lots of luck."}),(0,s.jsx)(n.z,{src:"/4/11.jpg"}),(0,s.jsx)("p",{children:"This picture was taken without any special light sources, but conditions were really good otherwise - a lot of sunlight and a white wall without anything reflecting on it."}),(0,s.jsx)("p",{children:"You don't want to shoot portraits with too wide lens to avoid distortions, so unless you have a studio (and if you do, why the hell are you even reading this?) or a huge room, you're bound to only portraits. Which is really limiting and you may run out of ideas pretty soon."}),(0,s.jsx)("p",{children:"So, you might switch to shooting people in their somewhat natural habitat, cities. I truly admire those who can just go out and point their camera on some random folks, and I'm not one of them."}),(0,s.jsx)(n.z,{src:"/4/12.jpg"}),(0,s.jsx)("p",{children:"This is my best attempt at streetphoto so far."}),(0,s.jsxs)("p",{children:[(0,s.jsx)("b",{children:"Please remember"})," to check your local regulations regarding photographing random people (especially minors) and then uploading those pictures!"]}),(0,s.jsx)(n.z,{src:"/4/13.jpg"}),(0,s.jsx)("p",{children:"If you're uncomfortable with the sreetphoto like me, you may try to shoot silhouettes of people. It doesn't tell a story (which a streetphoto is supposed to do), but it depicts people without showing their faces."}),(0,s.jsx)("h3",{children:"Conclusion"}),(0,s.jsx)("p",{children:"So, the picture should score some points of being interesting and being aesthetic. If it is only good in one of these two things - there's a room for improvement."})]})};t.default=function(){return(0,s.jsx)(o.d,{art:a.art,title:a.title,html:a.html})}}},function(e){e.O(0,[675,774,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);